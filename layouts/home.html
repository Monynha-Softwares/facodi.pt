{{ define "main" }}
  {{ $scratch := newScratch }}
  {{ $scratch.Set "coursesCount" 0 }}
  {{ $scratch.Set "ucCount" 0 }}
  {{ with site.GetPage "section" "courses" }}
    {{ range .Sections }}
      {{ if .Params.code }}
        {{ $scratch.Add "coursesCount" 1 }}
        {{ with .Params.ucs }}
          {{ $scratch.Add "ucCount" (len .) }}
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}

  <section class="facodi-hero">
    <div class="container-lg">
      <div class="facodi-hero__grid">
        <div class="facodi-hero__content">
          <div class="facodi-hero__intro">
            <span class="facodi-pill facodi-pill--brand facodi-hero__badge">{{ i18n "home.hero.badge" }}</span>
            <h1 class="facodi-hero__title">{{ .Title }}</h1>
            {{ with .Params.lead }}
            <p class="facodi-hero__description">{{ . | safeHTML }}</p>
            {{ end }}
          </div>
          <div class="facodi-hero__actions">
            <a class="facodi-hero__cta" href="{{ relLangURL "/courses/" }}" role="button">{{ i18n "home.hero.ctaPrimary" }}</a>
            <a class="facodi-hero__secondary" href="https://monynha.com" target="_blank" rel="noopener">{{ i18n "home.hero.ctaSecondary" }}</a>
          </div>
          <div class="facodi-hero__meta">
            <div class="facodi-hero__meta-item">
              <span class="facodi-pill facodi-pill--success">{{ i18n "home.hero.metaAccessTitle" }}</span>
              <p>{{ i18n "home.hero.metaAccessCopy" }}</p>
            </div>
            <div class="facodi-hero__meta-item">
              <span class="facodi-pill facodi-pill--outline">{{ i18n "home.hero.metaCommunityTitle" }}</span>
              <p>{{ i18n "home.hero.metaCommunityCopy" }}</p>
            </div>
          </div>
        </div>
        <div class="facodi-hero__card">
          <span class="facodi-hero__card-label">{{ i18n "home.hero.statsLabel" }}</span>
          <ul class="facodi-hero__stat-list">
            <li><strong>{{ $scratch.Get "coursesCount" }}</strong> {{ i18n "home.hero.statsCourses" }}</li>
            <li><strong>{{ $scratch.Get "ucCount" }}</strong> {{ i18n "home.hero.statsUcs" }}</li>
            <li>{{ i18n "home.hero.statsAudit" }}</li>
          </ul>
          <p class="facodi-hero__card-foot">{{ i18n "home.hero.statsFoot" | safeHTML }}</p>
        </div>
      </div>
    </div>
  </section>

  {{ with .Content }}
  <section class="facodi-section facodi-section--intro">
    <div class="container-lg">
      <div class="facodi-section__body">
        {{ . | safeHTML }}
      </div>
    </div>
  </section>
  {{ end }}

  {{ $features := slice
    (dict "icon" "üó∫Ô∏è" "title" (i18n "home.features.curriculumTitle") "description" (i18n "home.features.curriculumCopy"))
    (dict "icon" "üéß" "title" (i18n "home.features.playlistsTitle") "description" (i18n "home.features.playlistsCopy"))
    (dict "icon" "‚úÖ" "title" (i18n "home.features.progressTitle") "description" (i18n "home.features.progressCopy"))
    (dict "icon" "üåà" "title" (i18n "home.features.diversityTitle") "description" (i18n "home.features.diversityCopy"))
  }}
  <section class="facodi-section facodi-section--features">
    <div class="container-lg section-wrap">
      <div class="facodi-section__header section-header text-center">
        <span class="facodi-section__eyebrow">{{ i18n "home.features.eyebrow" }}</span>
        <h2 class="section-title facodi-section__title">{{ i18n "home.features.title" }}</h2>
        <p class="facodi-section__subtitle">{{ i18n "home.features.subtitle" }}</p>
      </div>
      <div class="facodi-grid facodi-grid--features">
        {{ range $features }}
        <div class="facodi-feature-card">
          <span class="facodi-feature-card__icon">{{ .icon }}</span>
          <h3 class="facodi-feature-card__title">{{ .title }}</h3>
          <p class="facodi-feature-card__description">{{ .description }}</p>
        </div>
        {{ end }}
      </div>
    </div>
  </section>

  {{ with site.GetPage "section" "courses" }}
  <section class="facodi-section facodi-section--courses">
    <div class="container-lg section-wrap">
      <div class="facodi-section__header facodi-section__header--split section-header">
        <div class="section-header section-header--flush">
          <span class="facodi-section__eyebrow">{{ i18n "home.courses.eyebrow" }}</span>
          <h2 class="section-title facodi-section__title">{{ i18n "home.courses.title" }}</h2>
          <p class="facodi-section__subtitle">{{ i18n "home.courses.subtitle" }}</p>
        </div>
        <div class="facodi-section__cta">
          <a class="facodi-link facodi-link--cta" href="{{ relLangURL "/courses/" }}">{{ i18n "home.courses.cta" }}</a>
        </div>
      </div>
      <div class="facodi-grid facodi-grid--courses">
        {{ $courses := .Sections }}
        {{ if not (len $courses) }}
          <div class="facodi-empty">{{ i18n "home.courses.empty" }}</div>
        {{ end }}
        {{ range $courses }}
          {{ if .Params.code }}
          <article class="facodi-course-card">
            <div class="facodi-course-card__body">
              {{ with .Params.plan_version }}
              <span class="facodi-pill facodi-pill--outline">{{ i18n "home.courses.plan" (dict "plan" .) }}</span>
              {{ end }}
              <h3 class="facodi-course-card__title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
              {{ with .Params.summary }}
              <p class="facodi-course-card__summary">{{ . }}</p>
              {{ end }}
            </div>
            <div class="facodi-course-card__meta">
              <div class="facodi-course-card__stats">
                {{ with .Params.ects_total }}<span><strong>{{ . }}</strong> {{ i18n "home.courses.ects" }}</span>{{ end }}
                {{ with .Params.duration_semesters }}<span><strong>{{ . }}</strong> {{ i18n "home.courses.semesters" }}</span>{{ end }}
                {{ with .Params.code }}<span>{{ i18n "home.courses.code" (dict "code" .) }}</span>{{ end }}
              </div>
              {{ with .Params.ucs }}
              <p class="facodi-course-card__foot">{{ i18n "home.courses.ucCount" (dict "count" (len .)) }}</p>
              {{ end }}
            </div>
          </article>
          {{ end }}
        {{ end }}
      </div>
    </div>
  </section>
  {{ end }}

  <section class="facodi-section facodi-section--journey">
    <div class="container-lg section-wrap">
      <div class="facodi-section__header facodi-section__header--split section-header">
        <div class="section-header section-header--flush">
          <span class="facodi-section__eyebrow facodi-section__eyebrow--light">{{ i18n "home.journey.eyebrow" }}</span>
          <h2 class="section-title facodi-section__title">{{ i18n "home.journey.title" }}</h2>
          <p class="facodi-section__subtitle">{{ i18n "home.journey.subtitle" }}</p>
        </div>
      </div>
      {{ $journey := slice (i18n "home.journey.step1") (i18n "home.journey.step2") (i18n "home.journey.step3") }}
      <ol class="facodi-journey__list">
        {{ range $journey }}
        <li>{{ . }}</li>
        {{ end }}
      </ol>
    </div>
  </section>
{{ end }}

{{ define "sidebar-prefooter" }}
<section class="facodi-section facodi-section--manifesto">
  <div class="container-lg section-wrap">
    <div class="facodi-manifesto">
      <span class="facodi-section__eyebrow">{{ i18n "home.manifesto.eyebrow" }}</span>
      <h2 class="section-title facodi-manifesto__title">{{ i18n "home.manifesto.title" }}</h2>
      <p class="facodi-manifesto__description">{{ i18n "home.manifesto.copy" }}</p>
      <a class="facodi-link facodi-link--cta" href="https://monynha.com" target="_blank" rel="noopener">{{ i18n "home.manifesto.cta" }}</a>
    </div>
  </div>
</section>
{{ end }}
