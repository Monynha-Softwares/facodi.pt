<!doctype html>
{{- $pageLayout := .Layout -}}
{{- if .IsHome -}}
  {{- $pageLayout = "home" -}}
{{- else if not $pageLayout -}}
  {{- if eq .Kind "section" -}}
    {{- $pageLayout = .Section -}}
  {{- else -}}
    {{- $pageLayout = .Type -}}
  {{- end -}}
{{- end -}}
{{- $dataMap := dict "page" $pageLayout -}}
{{- if eq $pageLayout "course" -}}
  {{- with .Params.code -}}
    {{- $dataMap = merge $dataMap (dict "course" .) -}}
  {{- end -}}
  {{- with .Params.plan_version -}}
    {{- $dataMap = merge $dataMap (dict "plan-version" .) -}}
  {{- end -}}
{{- else if eq $pageLayout "uc" -}}
  {{- with .Params.code -}}
    {{- $dataMap = merge $dataMap (dict "uc" .) -}}
  {{- end -}}
  {{- with .Params.course_code -}}
    {{- $dataMap = merge $dataMap (dict "course" .) -}}
  {{- end -}}
{{- else if eq $pageLayout "topic" -}}
  {{- with .Params.slug -}}
    {{- $dataMap = merge $dataMap (dict "topic" .) -}}
  {{- end -}}
  {{- with .Parent -}}
    {{- with .Params.code -}}
      {{- $dataMap = merge $dataMap (dict "uc" .) -}}
    {{- end -}}
    {{- with .Params.course_code -}}
      {{- $dataMap = merge $dataMap (dict "course" .) -}}
    {{- else -}}
      {{- with .Parent -}}
        {{- with .Params.course_code -}}
          {{- $dataMap = merge $dataMap (dict "course" .) -}}
        {{- end -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}
{{- $attrSlice := slice -}}
{{- range $key, $value := $dataMap -}}
  {{- if and $value (ne (printf "%v" $value) "") -}}
    {{- $attrSlice = $attrSlice | append (printf "data-%s=\"%s\"" $key (htmlEscape (printf "%v" $value))) -}}
  {{- end -}}
{{- end -}}
{{- $dataAttrs := delimit $attrSlice " " -}}
<html lang="{{ .Site.LanguageCode | default "pt-PT" }}" data-bs-theme="{{ site.Params.doks.colorMode | default "auto" }}">
  {{ partial "head/head" . }}
  {{ partial "head/body-class" . }}
  <body class="{{ delimit (.Scratch.Get "class") " " }}"{{ if $dataAttrs }} {{ $dataAttrs | safeHTML }}{{ end }}{{ if eq site.Params.doks.scrollSpy true }} data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0"{{ end }}>
    {{ partial "header/header" . }}
    <div class="wrap container-{{ site.Params.doks.containerBreakpoint | default "lg" }}" role="document">
      <div class="content">
      {{ if and (eq site.Params.doks.containerBreakpoint "fluid") (or (not (in .Site.Params.mainSections .Type)) (.IsNode)) }}<div class="container p-0">{{ end }}
        {{ block "main" . }}{{ end }}
      {{ if and (eq site.Params.doks.containerBreakpoint "fluid") (or (not (in .Site.Params.mainSections .Type)) (.IsNode)) }}</div>{{ end }}
      </div>
    </div>
    {{ block "sidebar-prefooter" . }}{{ end }}
    {{ block "sidebar-footer" . }}{{ end }}
    {{ partial "footer/footer" . }}
    {{ partial "footer/script-footer" . }}
    {{ if eq site.Params.doks.toTopButton true -}}
      {{ partial "footer/to-top" . }}
    {{ end }}
  </body>
</html>
